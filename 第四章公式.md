#### 第4章 飞机运动建模

用ROOM方法构造出运动核心层的框架后，需要对飞机的运动规律进行建模，根据飞机运动规律建立的飞机运动模型会直接影响到ATC仿真系统的仿真效果，是系统中的一个关键问题，本章主要进行飞机运动规律仿真建模的研究。目前在空中交通管制仿真中最常采用的飞机运动建模方法是使用固定直角坐标系对飞机运动模型进行研究，但是这种方法没有考虑地球曲率，不适用于大空域运动建模。针对这一问题，结合地球投影模型，本章提出了一种改进的建模方法，利用三维地理坐标系以及以运动目标质点为中心的运动坐标系，在每个计算周期进行地图投影映射进行运动建模。该方法考虑了地球的曲率，适用于建立飞机在大空域运动的的数学模型，同时又具有在直角坐标系推导运动模型简单方便等特点，适用于实时仿真计算。本章使用这种建模方法推导和建立了飞机的仿真数学模型，可以较为精确地仿真出飞机在大空域范围内的运动轨迹和飞机的运动姿态，实践应用证明该运动模型具有较高的仿真精度与较低的计算复杂度，能很好地满足空中交通管制仿真训练的要求。



#### 4.1引言

本文所讨论的飞机运动建模是指使用运动学的方法研究飞机在空中以及地面的运动规律，建立飞机的运动方程，逼真地模拟出飞机的运动过程，仿真出飞机的运动轨迹的方法。

早期在ATC仿真系统中对飞机运动规律的研究通常在固定直角坐标系例如NED ( North East Down)固定直角坐标系中进行，即选取地球表面除两个极点外的任一点(通常是仿真所在机场的机场中心点)为坐标原点建立一个直角坐标系，原点所在地点的正东方向为x轴正向，正北方向为y轴正向，重力方向为z轴正向，在此直角坐标系中推导飞机的运动模型。在小区域范围内，地球表面的曲率是十分微小的，通常可以假定地球表面是一个平面，此时使用这种方法建模可以推导出较为精确的运动模型。但是由于这种方法是建立在忽略地球表面曲率的基础上，因此使用它建立的运动模型具有一定的局限型，误差随着飞机运动空域的增大而增加，以至于到了一定的范围会产生严重的错误而无法准确仿真出飞机在大空域运动的轨迹，无法满足多机场、大空域联合训练的需求。

针对上述建模方法的不足，本章提出了一种改进的建模方法，此方法采用地心坐标系( Geocentric Coordinates，也叫三维地理坐标系)和随飞机运动而改变的运动坐标系相结合进行飞机运动建模，在运动坐标系中进行飞机运动模型的描述。运动坐标系的XY平面是地球表面经圆心投影(Gnomonic Projection) 映射而得到的，因此这种建模方法考虑了地球表面的曲率；由于运动坐标系本身是一个直角坐标系，在这一.坐标系中推导出的数学模型与原有的建模方法一样也具有计算简单的特点;同时在每一个仿真周期将计算结果映射回三维地理坐标系，解决了大空域运动仿真误差精度控制问题。

#### 4.2坐标系选择

##### 4.2.1地心坐标系

在地球科学领域，通常将地球看作- - 个平面椭圆绕其短轴(地轴)旋转而成的椭球体，这个旋转椭球体称为地球椭球体。根据WGS84的数据地球椭球体的扁率为1:298.257，用平均球面代替椭球面时相对于地球的半径来说误差很小(纬度每差10的经线长的最大误差为0.55%，经度每差10的纬线长的最大误差为0.42% )，对于飞机在空中运动轨迹的影响可以忽略不及，因此本文中为了方便计算，将地球看成一个正球体。
在地球体中，通过地心并垂直于地轴的平面叫赤道平面。地球表面的任一点的球面赤道平面与地球表面相交的圆圈叫赤道。与赤道平行的各个圆圈叫做纬圈，纬圈的一.段叫做纬线。包含地轴、与赤道平面相垂直的平面叫经线平面，经线平面与地球表面相交的圆叫经圈。每一个经圈被地球的两极分成两半，每一半就是一-条经线，其中通过英国伦敦格林威治天文台的经线称为起始经线，也叫主经线，这条经线所在的经线平面称为为初始子午面。
地心坐标系也叫三维地理坐标系，以LLA表示，是以地球质心作椭球中心，以过所求点c的椭球面法线与赤道平面的夹角φ为纬度，以过c点的子午面与初始子午面的二面角λ为经度，以c点沿法线到椭球面的距离为大地高h，用c点的三个分量(φ,2,h)表示其空间位置。对于任何地球空间点c，总存在

$c=\left\{(\varphi, \lambda, h) \mid(\varphi, \lambda, h) \in L L A, \varphi \in\left[0^{\circ}, \pm 90^{\circ}\right], \lambda \in\left[0^{\circ}, 180^{\circ}\right], h \in[-H,+H]\right\} \text { ( 4-1) }$

为了更方便地进行建模，我们对三维地理坐标系做了一点修改，即用c点的海拔高度e表示c点的第三个分量，即对于任何地球空间点c，总存在：

$${c=\left\{(\varphi, \lambda, e) \mid(\varphi, \lambda, e) \in L L A, \varphi \in\left[0^{\circ}, \pm 90^{\circ}\right], \lambda \in\left[0^{\circ}, 180^{\circ}\right], e \in[0,+H]\right\}(4-2)}$$







##### 4.2.2真经线和磁经线

地球周围空间存在一个磁场。地球磁场的两个磁极叫地球磁极，它们分别靠近地理的北极和南极。

地球上所描绘的经线，都是指向地理南北的方向线，叫做真经线，真经线的北端，用真北$N_{T}$表示。稳定的自由磁针所指的南北方向，叫做磁经线。磁经线的北端，用磁北$N_{M}$表示。

由于地磁极同地理极不在一处，并且地磁场分布不均匀，使得各地点的磁经线常常偏离真经线。磁经线北端偏离真经线北端的角度，叫做磁差角或磁偏角，用$\Delta_{M}$表示。



##### 4.2.3运动坐标系

建模过程中我们选用的另一个坐标系叫做运动坐标系${O} (t)$。设地球半径为R，飞机在t时刻在LLA中的位置为$P(\varphi_{0}, \lambda_{0}, e_{0})$，P与地球中心C的连线与地球表面的交点为O，平面γ是与地球切于O点的平面，将地球表面经纬度以C作为透视投影的透视顶，O作为投影中心，向平面γ做圆心投影(Gnomonic Projection， 也叫日晷投影) 参见图4.1，可以得到一-个平面投影坐标系${O}  ’(t)$：





${\left\{\begin{array}{l}x=R \times \frac{\cos (\varphi) \sin \left(\lambda-\lambda_{0}\right)}{\sin (\varphi) \times \sin \left(\varphi_{0}\right)+\cos (\varphi) \times \cos \left(\varphi_{0}\right) \times \cos \left(\lambda-\lambda_{0}\right)} \\y=R \times \frac{\sin (\varphi) \times \cos \left(\varphi_{0}\right)-\cos (\varphi) \times \sin \left(\varphi_{0}\right) \times \cos \left(\lambda-\lambda_{0}\right)}{\sin (\varphi) \times \sin \left(\varphi_{0}\right)+\cos (\varphi) \times \cos \left(\varphi_{0}\right) \times \cos \left(\lambda-\lambda_{0}\right)}\end{array}\right.} (4-3)$



此坐标系以运动目标的中心点在平面上的投影作为原点，当${\varphi_{0} \neq \pm 90^{\circ}}$时，O点所在经线的投影作为y轴，原点指向地理北极点在平面上的投影的方向作为y轴正向，在平面$\gamma $内过O点与y轴垂直的直线作为x轴，y轴在平面$\gamma $内绕O点顺时针旋转90°的方向作为x轴正向。

将${O}  ’(t)$进行扩展，我们得到${O} (t)$:

${\left\{\begin{array}{l}x=R \times \frac{\cos (\varphi) \sin \left(\lambda-\lambda_{0}\right)}{\sin (\varphi) \times \sin \left(\varphi_{0}\right)+\cos (\varphi) \times \cos \left(\varphi_{0}\right) \times \cos \left(\lambda-\lambda_{0}\right)} \\y=R \times \frac{\sin (\varphi) \times \cos \left(\varphi_{0}\right)-\cos (\varphi) \times \sin \left(\varphi_{0}\right) \times \cos \left(\lambda-\lambda_{0}\right)}{\sin (\varphi) \times \sin \left(\varphi_{0}\right)+\cos (\varphi) \times \cos \left(\varphi_{0}\right) \times \cos \left(\lambda-\lambda_{0}\right)} \\z=e-e_{0}\end{array}\right.} (4-4)$

这一坐标系是时间t的函数，在目标运动的过程中随t不断改变，称之为运动坐标系。



##### 4.2.4运动目标状态的描述

运动目标在一个特定时刻的状态可以由一个六元组$(\varphi,\lambda,e,h,p,r)$来描述，其中$(\varphi,\lambda,e)$描述了它作为一个质点在地心坐标系中的位置，$(h,p,r)$描述了它在运动坐标系$O(t)$中的欧拉角，其中$h$指机头朝向( heading)，$p$指飞机的俯仰角度(pitch)，$r$指飞机的侧倾角度( roll)。







#### 4.3建模方法

##### 4.3.1建模方法

在进行飞机运动规律计算的过程中，我们采用如下的建模方法:设飞机在t时刻的状态为${\left(\varphi_{0}, \lambda_{0}, e_{0}, h_{0}, p_{0}, r_{0}\right)}$，即在地理坐标系中的位置为$(\varphi_{0}, \lambda_{0}, e_{0})$，在$O(t_{0})$中 的姿态为$(h_{0}, p_{0}, r_{0})$。根据(4-4)我们得出，飞机在运动坐标系$O(t_{0})$中的位置为(0,0,0)。在这种建模方法中，我们将在$O(t_{0})$中进行飞机运动模型的推导，计算$t_{1} = t_{0} +\Delta t$时刻飞机在$O(t_{0})$坐标系中的位置$(x_{t}, y_{t}, z_{t})$以及姿态$(h_{t},p_{t}, r_{t})$，并将$(x_{t}, y_{t}, z_{t})$映射为地理坐标系中的位置$(\varphi_{t}, \lambda_{t}, e_{t})$。



##### 4.3.2投影误差分析

由于$O(t_{0})$的XY平面是地球表面的投影，因此我们的建模方法考虑了地球表面曲率对飞机位置的影响。我们选用的圆心投影具有如下的属性：从中心点到任何其它点的方向是正确的，因此在$O(t)$中进行建模时的方向与飞机在地心坐标系中的方向是一致的。但是圆心投影是有长度失真的，也就是说我们在$O(t)$中计算的位移是存在误差的。
假设飞机运动的最大速度是$v_{max}$，我们在$O(t)$中进行一次计算的周期为$\Delta t$，那么在一次计算周期中的最大位移是$v_{max} \times \Delta t$，一次计算周期的位移误差为：

${\varepsilon=v_{\max } \times \Delta t-\arctan \left(\frac{v_{\max } \times \Delta t}{R}\right) \times R(4-5)}$

设${x=v_{\max } \times \Delta t, \quad f(x)=\arctan \left(\frac{x}{R}\right)}$ ，将$f(x)$做Taylor级数展开，可以得到：

${f(x)=\frac{x}{R}-\frac{x^{3}}{3 R^{3}}+\frac{x^{5}}{5 R^{5}}-\frac{x^{7}}{7 R^{7}} \cdots(4-6)}$

将（4-6）代入（4-5），有

${\varepsilon=\frac{x^{3}}{3 R^{2}}-\frac{x^{5}}{5 R^{4}}+\frac{x^{7}}{7 R^{6}} \cdots(4-7)}$

根据WGS84 的数据，地球的长轴半径6378137m， 短轴半径6356752m,平均半径约为6371000m，我们以民航史上最快的客机T144为例来分析：T144的最大巡航速度约为700m/s，如果每一秒钟计算一次，则每秒的计算误差约为$ε≈2.8168\times10^{-6}$,连续飞行24小时的误差也不超过0.3m，这一误差是可以忽略不计的。
下面我们将具体讨论飞机在地面以及空中的运动规律建模。描述运动模型时所用的坐标系如没有特别说明，指运动坐标系${O} (t_{0})$。



#### 4.4飞机运动建模的一些基本概念

##### 4.4.1航线

飞机从地球表面一点(起点)到另一点(终点)的预定的航行路线叫航线，也称为预计航迹。由于地面导航设施、空中交通管理、飞行任务、地形等因素的影响，一条航线常常由起点、转弯点、终点和航路点构成，其中还包括指定的或飞行员自选的检查点，这样的航线我们成为航路。

在目视飞行规则( VFR，Visual Flight Rules)条件下，通常以起飞机场作为航线起点，以着陆机场作为航线终点，转弯点和检查点则是一些明显易辨的地面景物;在仪表飞行规则(IFR， Instrument Flight Rules)下飞行，通常以起飞机场和着陆机场的主降方向距台或附近的归航台为航线起点和终点，而转弯点和检查点则是一些无线电导航点或定位点;实施区域导航时，这些航路点则是一些采取经纬度表示的选定的点。

航线(航段)的方向用航线角(Course) 表示，即从航线起点的经线北端顺时针量到航线去向的角度。航向角分为真航线角和磁航线角。航线有大圆航线和等角航线两种。以通过两航路点间的大圆圈线作为航线的叫做大圆航线，大圆航线上各点的真航线角不相等，单航线距离最短。以通过两航路点间的等角线作为航线的就叫等角航线，等角航线是一条盘向两极的螺旋形曲线，等角航线上各点的航线角相等，但它的距离一般比大圆航线长。

大圆航线距离虽短，但在“飞行种需要经常改变航线角，极不方便;等角航线虽然距离长，但可以在飞行中不改变航线角一直到达目的地。因此实际飞行中必须根据不同的情况进行选择;一般在近程飞行，相差距离很小时，选用等角航线;远程飞行时，则必须计算出两者相差的数值，然后根据差值的大小选择一种或者两者配合，最常用的方法
是全程采用大圆航线，然后将大圆航线根据实际情况分为几个航段，每一个航段按等角航线飞行。

##### 4.4.2航向

飞机纵轴前方的延长线叫做航向线。航向线的指向叫做航向。飞机的航向可以用真航向或磁航向表示。

以真经线为基准，从真经线北端顺时针量到航向线的角度，叫真航向，用$h_{T}$表示。以磁经线为基准，从磁经线北端顺时针量到航向线的角度，叫磁航向，用$h_{N}$表示。

##### 4.4.3航迹

飞机相对于地面运动所经过的路线，叫航迹线，航迹线的方向角用航迹角(Track) 表示。航迹角分为真航迹角和磁航迹角两种。从真经线北端顺时针量到航迹线去向的角度，叫做真航迹角(TrueTrack,TTK);从磁经线北端顺时针量到航迹线去向的角度，角磁航迹角( Magnetic Track, MTK )。



##### 4.4.4空速

飞机相对于空气运动的速度叫做空速。空速的大小是根据相对气流流速与动压的关系，通过空速表测量出来的。按照空速表测定空速的误差情况可以分为以下几种:

* 仪表空速：仪表空速简称表速，是仪表空速表根据海平面标准大气条件下相对气流流速与动压之间的关系所测定的空速，这种空速存在各种误差(机械误差、空气动力误差、空气压缩性修正量误差和密度误差等)，同飞机相对于空气运动的真实速度相差很大;
* 修正空速：仪表空速经过机械误差的修正后，就是修正表速；
* 指示空速：修正空速经过空气动力误差修正后就是只是空速。在实际飞行中，由于机械误差和空气动力误差都比较小，一般不作修正，就把仪表所指示的空速看成指示空速。
* 当量空速:这是空速经过空气压缩性修正量误差的修正后，就是当量空速，它反映了海平面标准大气条件下相对气流流速同动压的关系，仅存在空气密度误差;
* 真空速:当量空速经过密度误差修正后，也就是飞机相对空气运动的真实速度，称为真空速。在空中交通管制中使用的是真空速，用$v_{TAS}$表示。

##### 4.4.5地速

飞机相对地面运动的水平速度，即单位时间里所飞过的地面水平距离，叫地速( Ground Speed, GS)，用$V_{GS}$表示。

##### 4.4.6风向、风速

空气团对地面水平运动的方向叫风向。风向有两种表示方法，一种是气象台所测量和预报的风向，是指风吹来的真方向，即从真经线北端顺时针量到风的来向的角，叫气象风向( Meteorological Wind Direction，MWD)，用$wd_{m}$表示；另一种是领航学上所用的风向，指风吹去的磁方向，即从磁经线北端顺时针量到风的去向的角度，叫做航
行风向( Navigational Wind Direction，NWD)，用$wd_{n}$表示。

空气团对地面水平运动的速度，即单位时间内空气流经地面的水平距离叫风速，用ws表示

##### 4.4.7偏流

由于侧风的影响，飞机的航迹线会偏离航向线。航迹线偏离航向线的角度叫偏流( Drift Angle，DA)。左侧风时，航迹线偏到航向线的右侧，规定偏流为正值，叫右偏流(RDA);右侧风时，航迹线偏到航向
线的左侧，偏流为负值，叫右偏流(LDA)。

##### 4.4.8风角

风向线与航迹线之间的夹角，叫做风角( Wind Angle，WA)，用来表示飞机侧风的情况。

##### 4.4.9风对飞机航行的影响

推导飞机在地面的运动模型时，我们可以假设地面运动不受风的影响;在空中飞行的过程中，风对飞机运动的影响是不能被忽略的。

飞机在空中飞行，同时存在着两种相对运动。一种是飞机相对于空气的运动，用空速向量即磁航向和真空速表示;另一种是飞机相对于地面的运动，用地速向量即磁航迹角和地速表示。

在没有风的情况下，上述两种相对运动是完全一-致的。在有风的情况下，风速向量和飞机的空速向量、地速向量构成了一个三角形(见图4.2)，叫做航行速度三角形，它准确地反映了风对飞机航行影响的基本规律。航行速度三角形包含了八个最常用的航行元素，即磁航向$h_{N}$和真空速$V_{TAS}$、风向$wd_{m}$和风速ws、磁航迹角MTK和地速$V_{GS}$、偏流DA和风角WA。

在仿真计算的过程中，我们用是真航向$h_{T}$和真空速$V_{TAS}$，气象风向wd和风速ws，以及真航迹角TTK和地速$V_{GS}$来构建航行速度三角形。图4.4是航行速度三角形在$O(t)$中的表示，在$O(t)$中，我们将$h_{T}$, TTK，$wd_{n}$,转化为用h, $h_{GS}$和wd进行计算。

${\left\{\begin{array}{l}h=\frac{\pi}{2}-h_{T} \\h_{G S}=\frac{\pi}{2}-T T K \quad(4-8) \\w d=\frac{\pi}{2}-w d_{n}\end{array}\right.}$

在$O(t)$中，目标的航向为h，真空速大小为$V_{TAS}$，风向为wd，风速为ws，根据航行速度三角形，我们可以推导出目标的地速$V_{GS}$

${v_{G S}=\left(\begin{array}{l}v_{\text {tas }} \times \cos (h)+w s \times \cos (w d) \\v_{\text {tas }} \times \sin (h)+w s \times \cos (w d)\end{array}\right)=\left(\begin{array}{l}v_{x} \\v_{y}\end{array}\right)(4-9)}$

其中${v_{\text {tas }} \times \cos (h)+w s \times \cos (w d)}$表示地速在$O(t)$中x方向的分量，用$v_{x}$表示，${v_{\text {tas }} \times \sin (h)+w s \times \cos (w d)}$表示地速在$O(t)$中y方向的分量，用$v_{y}$表示。

下面的建模推导过程中所提到运动目标的速度如没作特别说明，指的是运动目标的地速。





##### 4.5地面运动模型

在地面滑行时，用一系列的点描述运动目标的运动。在建立地面运动模型前，对于目标在地面滑行时的运动，我们做以下两点假设:

(1)地面运动不受风的影响，地速与真空速相同;

(2)在一个计算周期内滑行为匀加速运动:

同时，假设目标的以下运动性能已知:

(1)前轮最大偏转角: D;

(2)前后轮距: L;

(3)最小转弯速度为: $V_{min}$ ;

(4)最大滑行速度: $V_{max}$ ;

(5)正常滑行速度:$V_{nor}$;

(6)以 $V_{max}$可以完成的最小转弯半径: $R_{max}$

此外，对于机场上的每一个位置$pt$，根据其在机场上的功能，都将被关联上一个目标的某一种滑行速度，我们以$v(pt)$来表示，表明目标在机场上$pt$点正常滑行时的滑行速度,

例如:$v(runway)=v_{max}$，表示运动目标在跑道上以最大速度滑行:

$v(gate)=v_{min}$，表示运动日标在停机坪上以最小速度滑行;

对于描述目标运动的每一个点我们都定义一个以此点为圆心以L为半径的圆形调整区域(参见图4.5)， 并且规定运动目标进入调整区域的速度不能超过某一个限定速度$vl_{max}(pt)$。这样，我们就可以将目标在两个点之间的运动分为以下两个子状态:在调整区域内的状态和在两个点的调整区域间的状态。

下面对运动目 标在连续的两个点之间的运动进行分析，设起始点的坐标为$P_{s}(x_{s},y_{s},z_{s})$，结束点的坐标为$P_{s}(x_{e},y_{e},z_{e})$,目标一旦进入$P_{e}$的调整区域则重新设置$P_{s}$和$P_{e}$即P$P_{s} = P_{e}$，$P_{e} = P_{e(next)}$， 根据上面的规则，下面的分析只对$(P_{s}, P_{e})$两个点进行。

先根据(4-10) 式判断目标在$(P_{s}, P_{e})$两点间作直线运动还是需要在运动的过程中进行方向调整:

若${h=\theta\left(\overrightarrow{P_{e-} P_{s}}\right)}$，则目标不需要进行方向调整(4- 10)

若${h\ne\theta\left(\overrightarrow{P_{e-} P_{s}}\right)}$ ，则目标需要在$P_{s}$的调整区域内进行方向调整

上式中$\theta(\overrightarrow{P_{e-} P_{s}})$表示矢量P_ P的方向，下面的用法相同。

首先分析${h=\theta\left(\overrightarrow{P_{e-} P_{s}}\right)}$的情况，此时目标在两点间作直线运动，并且有$vl_{max}(p_{e})=v(p_{e})$。
在运动坐标系$O(t_{0})$中，设目标在$t_{0}$时刻的状态为${\left(0, 0, 0, h_{0}, p_{0}, r_{0}\right)}$,运动速度为$v_{0}$，加速度为a。那么在$t_{0} + \Delta t$时刻，运动目标的状态为${\left(x_{t}, y_{t}, z_{t}, h_{t}, p_{t}, r_{t}\right)}$,对于情况，推导出的运动模型如下:

${\left\{\begin{array}{l}v_{t}=\left\{\begin{array}{l}v_{0}+a \times \Delta l, v_{0}<v l_{\max }\left(p_{e}\right) \\v_{0}, v_{0} \geq v l_{\max }\left(p_{e}\right)\end{array}\right. \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(h_{0}\right) \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=r_{t}=0\end{array}\right.} (4-11)$

下面分析${h\ne\theta\left(\overrightarrow{P_{e-} P_{s}}\right)}$的情况,此时目标需要进行方向的调整,在$P_{s}$和$P_{e}$两点之间的某一段做圆周运动。

运动物体的在一.定的速度下的最小转弯半径与速度成一定的关系，速度越大，则转弯半径越大，为了简化计算，我们假设转弯速度v与此速度下的最小转弯半径R的关系为:
${v=a R^{2}+b R     (4-12)}$

目标的最小转弯半径由前轮最大偏转角以及前后轮距确定:${R_{\min }=\frac{L}{D}}$，根据前面的假设，我们可以得出:

${\left\{\begin{array}{l}v_{\min }=a R_{\min }^{2}+b R_{\min } \\v_{\max }=a R_{\max }^{2}+b R_{\max }\end{array}\right.(4-13)}$

由(4-13)式，我们可以求出(4-12)中的参数:

${\left\{\begin{array}{l}a=\frac{v_{\min } R_{\max }-v_{\max } R_{\min }}{R_{\min } R_{\max }\left(R_{\min }-R_{m a x}\right)} \\b=\frac{v_{\min } R_{\max }^{2}-v_{\max } R_{\min }^{2}}{R_{\min } R_{\max }\left(R_{\max }-R_{\min }\right)}\end{array}\right.(4-14)}$


在图4.4中，设目标从$P_{1}$点经$P_{2}$点滑行至$P_{3}$点。进出$P_{2}$调整区域的位置分别为A和B，设${\theta=\frac{\angle A P_{2} B}{2}}$，设目标以最小转弯半径转弯所需的切入点到$P_{2}$的距离为${d_{\min }=\frac{R_{\min }}{\tan \theta}}$。

可以得到${v l_{\max }\left(p_{e}\right)=\min \left(v\left(p_{e}\right), a R_{\min }^{2}+b R_{\min }\right)}$;目标在P进入A点之间滑行时必须保证能按照不大于$vl_{max}(p_{e})$ 的速度到达A点，我们据此推导出目标在P到A点$(x_{A}, y_{A})$之间的运动方程为:

$\left\{\begin{array}{l}v_{t}=\left\{\begin{array}{l}v_{0}+a \times \Delta t, v_{0}<v l_{\max }\left(p_{s}\right) \\v_{0}, v_{0} \geq v l_{\max }\left(p_{e}\right) \text { 且 } v_{0} \times T+\frac{1}{2} \times a \times T^{2} \leq d \\v_{0}-a \times \Delta t, v_{0}>v l_{\max }\left(p_{e}\right) \text { 且 } v_{0} \times T+\frac{1}{2} \times a \times T^{2}>d\end{array}\right. \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(h_{0}\right) \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=r_{t}=0\end{array}\right. (4-15)$

其中${T=\frac{\left|v_{0}-v l_{\max }\left(p_{e}\right)\right|}{a}, d=\sqrt{x_{A}{ }^{2}+y_{A}^{2}}}$。

目标滑行至A后，进入圆周运动阶段，令${h_{e}=\theta\left(\overrightarrow{P_{e-} P_{s}}\right)}$，目标要在以$P_{s}$为圆心L为半径的调整区域内完成h到$h_{e}$的调整。

首先根据当前方向和目标方向确定飞机的转弯方向为:

${f(x)=\left\{\begin{array}{l}1,0<h_{e}-h_{0}<\pi, \text { 左转 } \\-1, \pi<h_{e}-h_{0}<2 \pi, \text { 右转 }\end{array}(4-16)\right.}$

对于目标在调整区域内的运动，我们用矢量的方式给出运动模型。设当前位置为$X_{0}(x_{0},y_{0})$，当前航向的法矢量为$N_{0}$，当前圆心的矢量为$C_{0}$，如图4.6，则有:

${\left\{\begin{array}{l}v_{t}=v_{0} \\X_{t}=C_{0}+N_{t} \\h_{t}=h_{0}+\frac{v_{t}}{R} \times \Delta t \times f(x) \\z_{t}=p_{t}=r_{t}=0\end{array}\right.(4-17)}$

其中${\theta\left(N_{t}\right)=\theta\left(N_{0}\right)+\left(v_{0} \times \Delta t\right) / R}$





##### 4.6起飞模型

飞机的起 飞是指飞机从开始在跑道上滑跑到离开地面上升到起飞安全高度H (50 英尺或15米)并加速到安全起飞速度的过程。飞机的起“飞过程一般分为起飞滑跑、离地、上升三个阶段，图4.7为飞机的起飞过程示意图。

${\left\{\begin{array}{l}v_{t}=v_{0}+a \times \Delta t \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(h_{0}\right)(4-18) \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=r_{t}=0\end{array}\right.(4-18)}$

研究飞机起飞的运动模型时，我们将其分为滑跑、抬前轮(后轮滑跑)、离地爬升三个阶段分别进行建模。

假设飞机的如下性能已知:

(1) 飞机抬前轮的速度$V_{R}$;

(2) 飞机的离地速度$V_{LOF}$

(3) 飞机的滑跑加速度a:

(4)“ 飞机起飞倾角为$p$;

(5) 飞机的俯仰率为PR;

在飞机在运动坐标系$O(t_{0})$中$t_{0}$时刻的状态为${\left(0, 0, 0, h_{0}, p_{0}, r_{0}\right)}$,每一个仿真周期为，$\Delta t$在$t_{0} + \Delta t$时刻，运动目标的状态为${\left(x_{t}, y_{t}, z_{t}, h_{t}, p_{t}, r_{t}\right)}$,对于情况，推导出的运动模型如下:

滑跑阶段的运动模型:

${\left\{\begin{array}{l}v_{t}=v_{0}+a \times \Delta t \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(h_{0}\right)(4-19) \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=p_{0}+P R \times \Delta t \\r_{t}=r_{0}=0\end{array}\right.(4-19)}$

当$v_{t} \ge  V_{LOF}$时，滑跑阶段结束，飞机进入抬前轮阶段。抬前轮阶段的运动模型为:

${\left\{\begin{array}{l}v_{t}=v_{0}+a \times \Delta t \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(p_{0}\right) \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(p_{0}\right) \times \sin \left(h_{0}\right) \\z_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(p_{0}\right) \\h_{t}=h_{0} \\p_{t}=p_{0} \\r_{t}=r_{0}=0\end{array}\right.(4-20)}$

##### 4.7着陆模型

着陆是指飞机以着陆进场速度从着陆进场高度H下滑，降落到地面，并在跑道上滑跑直至完全停止运动或脱离跑道的过程，如图4.8。

研究飞机着陆模型的时候，我们将其划分为下滑、拉平、平飘、滑跑等四个阶段分别进行建模。

假设飞机的如下性能已知:

( 1)俯仰率$PR$;

(2) 下滑角$\alpha$;

(3)着陆跑道的角度为hr;

设飞机在运动坐标系$O(t_{0})$中$t_{0}$时刻的状态为${\left(0, 0, 0, h_{0}, p_{0}, r_{0}\right)}$,每一个仿真周期为，$\Delta t$在$t_{0} + \Delta t$时刻，运动目标的状态为${\left(x_{t}, y_{t}, z_{t}, h_{t}, p_{t}, r_{t}\right)}$,。
下滑阶段认为飞机做匀速运动，下滑阶段模型为:

${\left\{\begin{array}{l}v_{t}=v_{0} \\x_{t}=v_{0} \times \cos \left(p_{0}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=v_{0} \times \cos \left(p_{0}\right) \times \Delta t \times \sin \left(h_{0}\right) \\z_{t}=-v_{0} \times \sin \left(p_{0}\right) \times \Delta t \\h_{t}=h r \\p_{t}=\left\{\begin{array}{l}p_{0}-P R \times \Delta t, p_{0}>\alpha \\p_{0}, p_{0} \leq \alpha\end{array}\right. \\r_{t}=0\end{array}\right.(4-21)}$

拉平阶段的模型为：

${\left\{\begin{array}{l}v_{t}=v_{0} \\x_{t}=v_{0} \times \cos \left(p_{0}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=v_{0} \times \cos \left(p_{0}\right) \times \Delta t \times \sin \left(h_{0}\right) \\z_{t}=-v_{0} \times \sin \left(p_{0}\right) \times \Delta t \\h_{t}=h_{0} \\p_{t}=\left\{\begin{array}{l}p_{0}+P R \times \Delta t, p_{0}<0 \\0, p_{0} \geq 0\end{array}\right. \\r_{t}=0\end{array}\right.(4-22)}$

当$p_{t}=0$时，拉平阶段结束，飞机进入平飘阶段，平飘阶段的模型为:

${\left\{\begin{array}{l}v_{t}=v_{0}+a \times \Delta t \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(h_{0}\right) \\z_{t}=-\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \tan \left(p_{0}\right) \\h_{t}=h_{0} \\p_{t}=p_{0}+P R \times \Delta t \\r_{t}=0\end{array}\right.(4-23)}$

当z=0时，平飘阶段结束，飞机进入滑跑阶段，滑跑阶段的模型为:

${\left\{\begin{array}{l}v_{t}=v_{0}+a \times \Delta t \\x_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \cos \left(h_{0}\right) \\y_{t}=\frac{1}{2} \times\left(v_{0}+v_{t}\right) \times \Delta t \times \sin \left(h_{0}\right) \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=\left\{\begin{array}{l}p_{0}-P R \times \Delta t, p_{t}>0 \\0, p_{t} \leq 0\end{array}\right. \\r_{t}=0\end{array}\right.(4-24)}$

#### 4.8空中运动建模

研究飞机在空中飞行的运动规律时，我们把飞机看作全部质量集中在质心的质点，用飞机质心的运动代替飞机的运动。

##### 4.8.3巡航模型

飞机在空中的巡航方式有两种:按时间巡航方式以及按关键点巡航方式。第一种巡航方式是指让飞机按当前航向飞行给定的时间;第二种巡航方式给出两个指定的关键点，让飞机按照当前航向飞行直到飞过当前位置与方向所确定的直线与两个指定关键点所确定的直线的交点。

无论按照哪种方式巡航，飞机的航向都不调整，因此，可以直接用当前地速进行计算，推导出飞机的巡航模型:

${\left\{\begin{array}{l}x_{t}=v_{x} \times \Delta t \\y_{t}=v_{y} \times \Delta t \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=0 \\r_{t}=0\end{array}\right.(4-25)}$

##### 4.8.4盘旋模型

盘旋是指飞机在水平面内连续转弯不小于360度的飞行，在盘旋的过程中飞机的飞行高度、飞行速度以及盘旋半径均不随时间变化。设飞机开始盘旋时的真空速为$V_{tas}$，盘旋坡度为γ，航向为$h_{0}$。

飞机盘旋过程中受到的作用力有升力L、重力G、拉力P和阻力D。根据升力的作用，可将其分解为垂直方向的分量$L_{1}$和水平方向的分量$L_{2}$，其中$L_{2}$，作为飞机盘旋的向心力，如图4. 9。





飞机盘旋的条件可得飞机盘旋的运动方程：



${\left\{\begin{array}{l}G=L_{1}=L \times \cos \gamma \\P=D \\\frac{G}{g} \times \frac{v_{\text {tas }}{ }^{2}}{R}=L_{2}=L \times \sin \gamma\end{array}\right.(4-26)}$



根据(4-25)可求出飞机盘旋的半径${R=\frac{v_{\text {tas }}^{2}}{g \tan \gamma}}$。

下面求飞机盘旋的中心点$C(x_{c},y_{c})$。首先求出向心矢量的方向角${\theta=h_{0}+f(x) \times \frac{\pi}{2}}$，其中$f(x)$由盘旋模式决定：

${f(x)=\left\{\begin{array}{l}1, \text { 左转弯盘旋 } \\-1, \text { 石转弯盘旋 }\end{array}(4-27)\right.}$



$\left\{\begin{array}{l}x_{c}=x_{0}+R \times \cos \theta \\y_{c}=y_{0}+R \times \sin \theta\end{array}(4-28)\right.$

根据(4-29)我们可以推导出飞机盘旋的运动模型:

${\left\{\begin{array}{l}x_{t}=x_{c}-R \times \cos \left(\theta+\frac{v_{G A S}}{R} \times \Delta t \times f(x)\right) \\y_{t}=y_{c}-R \times \sin \left(\theta+\frac{v_{G A S}}{R} \times \Delta t \times f(x)\right) \\z_{t}=0 \\h_{t}=h_{0}+\frac{v_{G A S}}{R} \times \Delta t \times f(x) \\p_{t}=0 \\r_{t}=\left\{\begin{array}{l}r_{0}+R r \times \Delta t, r_{0}+R r \times \Delta t<\gamma \\\gamma, r_{0}+R r \times \Delta t \geq \gamma\end{array}\right.\end{array}\right.}(4-29)$

##### 4.8.5线路飞行模型

飞机在空中飞行的过程中，指挥员或管制员通常会指挥飞机飞过一系列的关键点，如导航台，特殊的地理坐标点等，这种飞行行为称为线路飞行。

线路飞行是飞机在空中最常用的一种飞行状态。整个线路飞行过程可以看成是从当前位置飞到下一个关键点，直到最后一个关键点。

设飞机地速方向为$h_{GS0}$，${P_{0}\left(\varphi_{0}, \lambda_{0}\right)}$为当前 飞机位置，${P_{1}\left(\varphi_{1}, \lambda_{1}\right)}$为 要到达的关键点，飞机要从$P_{0}$飞向$P_{1}$，必须根据$h_{GS0}$与矢量${\overrightarrow{P_{0} P}}$之间的关系以及风速和风向调整飞机航向。

通常在飞机的实际飞行中，在短距离内飞行，飞行员无法很好地控制飞机飞出大圆航线，因此一般在每一段航段，即两个关键点间通常使用等角航线模拟。设飞机当前的经纬度为${P_{0}\left(\varphi_{0}, \lambda_{0}\right)}$，当前地速方向为$h_{GS0}$,设导航台的经纬度为${P_{1}\left(\varphi_{1}, \lambda_{1}\right)}$，飞到导航台时要求飞机地速方向为$h_{GS1}$。飞机从$P_{0}$飞向$P_{1}$可以分成三个阶段:调整航向、直线飞行、调整航向，如图4. 10。



在运动坐标系$O(t)​$中，过飞机的当前点可以做两个与过飞机方向矢量${\vec{H}_{G S 0}}​$相切的圆，分别是飞机进行左盘旋(逆时针)和右盘旋(顺时针)的圆，同理，过飞机的目标点也可以做两个与目标点所要求方向矢量${\vec{H}_{G S 1}}​$相切的圆。飞机进行线路“ 飞行的过程可以描述为，首先在与当前方向相切的圆上进行航向调整，然后进行一段直线飞行，飞向与目标航向相切的圆上，再进行航向调整，飞到目 标点。因为在飞机当前点和目标点各有左、右盘旋两个圆，因此，飞机从当前点飞到目标点可以有四种情况:右转向一直线一右转向，图4.10中的第1条路线;左转向一直线一左转向，图4.10中第2条路线:右转向一直线一左转向，图4.10中的第3条路线;左转向一直线一右转向，图4.10中的第4条路线。

现在我们可以把飞机在空中进行线路飞行的问题简化为以下两个问题:

* 在指定飞机转弯方向的情况下，选择航向调整的结束点和起始点。

* 在未指定飞机转弯方向的情况下，找出第一次调整航向和第二次调整航向的方向，使其可以以最短路径调整完成调整航向、直线飞行、调整航向三个步骤，最终以目标航向到达目标点;

  对于第一个问题，我们提出了以下的算法:



第一次调整航向:

${\left\{\begin{array}{l}x_{t}=x_{c}-R \times \cos \left(\theta+\frac{v_{G A S}}{R} \times \Delta t \times f(x)\right) \\y_{t}=y_{c}-R \times \sin \left(\theta+\frac{v_{G A S}}{R} \times \Delta t \times f(x)\right) \\z_{t}=0 \\h_{t}=h_{0}+\frac{v_{G A S}}{R} \times \Delta t \times f(x) \\p_{t}=0 \\r_{t}=\left\{\begin{array}{l}r_{0}+R r \times \Delta t, r_{0}+R r \times \Delta t<\gamma \\\gamma, r_{0}+R r \times \Delta t \geq \gamma\end{array}\right.\end{array}\right.(4-30)}$

由(4-30) 计算出飞机$t$时刻在$O(t_{0})$中的位置$X_{t}(x_{t},y_{t})$和航向$h_{t}$，做一条过$X_{t}$方向为$h_{t}$的射线$L(t)$，当$L(t)$与圆$O_{1}(x)$相切时，第一次航向调整结束。其中.

${O_{1}(x)=\left\{\begin{array}{l}O_{1 L}, \text { 左转変盘旋 } \\O_{1 R}, \text { 石转変舟旋 }\end{array}(4-31)\right.}$

直线飞行阶段的模型为

${\left\{\begin{array}{l}x_{t}=v_{x} \times \Delta t \\y_{t}=v_{y} \times \Delta t \\z_{t}=0 \\h_{t}=h_{0} \\p_{t}=0 \\r_{t}=0\end{array}\right.(4-32)}$

由(4-32)计算出飞机t时刻在$O(t_{0})$中的位置$X_{t}(x_{t},y_{t})$， 当$X_{t}$在圆$O_{1}(x)$上时，直线飞行阶段结束。飞机开始进入 第二此航向调整阶段。

飞机第二次航向调整方程为(4- 30)， 当飞机位置$X_{t} = P_{1}$时，线路飞行阶段结束。

对于第二个问题，我们采用了如下的最优路径策略:

(1)首先确定第二次航向调整的盘旋方向:以目标点作为原点，目标方向作为y轴正方向，建立一个平面直角坐标系，如果飞机当前点在此坐标系的一、四象限，则第二次航向调整为顺时针左盘旋，否则为逆时针右盘旋。

(2)从飞机当前点到目标圆弧的关系来确定第一次航向调整的方向，

如果向右转才能与目标圆弧相切，那么顺时针调整，否则逆时针旋转。

(3)在第一次航向调整的时候，如果飞机位置“跳点”(从目标方向的左边转向右边，或从目标方向的右边转向左边)，马上调整第二次航向盘旋方向，如果第二次航向调整原来判断为顺时针左盘旋，跳点后变为逆时针右盘旋。



#### 4.9本章小结

提出了一种使用运动坐标系与三维地理坐标系相结合进行运动建模的建模方法，推导和建立了运动目标的大范围仿真数学模型。实践应用表明其该模型具有较高的仿真精度与较低的计算复杂度，能很好的满足仿真训练对实时性的要求，同时符合空中交通管制仿真训练的仿真精度要求。























